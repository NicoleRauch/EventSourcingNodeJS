<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>reveal.js</title>

		<link rel="stylesheet" href="../reveal.js/css/reveal.css">
		<link rel="stylesheet" href="../reveal.js/css/theme/beige.css">

		<!-- Theme used for syntax highlighting of code 
		<link rel="stylesheet" href="../reveal.js/lib/css/zenburn.css">
-->
        <link rel="stylesheet" href="default-highlight.css">
        <link rel="stylesheet" href="custom.css">

        <link rel="stylesheet" href="Lato.css" type="text/css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? '../reveal.js/css/print/pdf.css' : '../reveal.js/css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
              <!-- ********************************************************************************** -->
              <!-- Event Sourcing a Node.js Application -->
              <!-- ********************************************************************************** -->
              <section>
                <h1>Event Sourcing a Node.js Application</h1>
                <div align="right">
                <img width="30%" src="../logos/German.png"/>
                </div>
              </section>
              
              <!-- ********************************************************************************** -->
              <!-- Story - Why Event Sourcing? -->
              <!-- ********************************************************************************** -->
              <section>
                <! ---------------------------------------------------------------------------------- -->
                <section>
                  <h2>Why Event Sourcing?</h2>
                  <h3>Or:</h3>
                  <h3>How this all began</h3>
                </section>
                
                <! ---------------------------------------------------------------------------------- -->
                <section>
                  SoCraTes Conference 2015
                  
                  11 users were incorrectly denied registration due to a bug
                  
                  We could not find out from the system who these users were
                  
                  2 or 3 complained, but the others? Gone (and probably disappointed).
                </section>
                
                <! ---------------------------------------------------------------------------------- -->
                <section>
                  The bug: 2-phase registration (reservation -> registration)
                  
                  reservation was made, but registration was denied
                  
                  reservation token only contained session id
                  was deleted after 30 minutes
                  
                  -> we were unable to see who actually made the reservation
                  
                  How can this be improved?
                </section>

                <! ---------------------------------------------------------------------------------- -->
                <section>
                </section>
              </section>
              
              <!-- ********************************************************************************** -->
              <!-- What is Event Sourcing? -->
              <!-- ********************************************************************************** -->
              <section>
                <! ---------------------------------------------------------------------------------- -->
                <section>
                  <h2>Event Sourcing</h2>
                  <h3>Or:</h3>
                  <h3>Don't Drop Data!</h3>
                </section>

                <! ---------------------------------------------------------------------------------- -->
                <section>
                  Usually: Relational Database
                  
                  Only captures current state!
                  
                  No information about previous states
                  No information why some change happened
                </section>

                <! ---------------------------------------------------------------------------------- -->
                <section>
                  How to improve this?
                  
                  Record everything that happened, and why.
                </section>

                <! ---------------------------------------------------------------------------------- -->
                <section>
                  Grafik ES - schrittweise aufbauen
                </section>

                <! ---------------------------------------------------------------------------------- -->
                <section>
                </section>

                <! ---------------------------------------------------------------------------------- -->
                <section>
                </section>
              </section>

              <!-- ********************************************************************************** -->
              <!-- Naive Approach -->
              <!-- ********************************************************************************** -->
              <section>
                <! ---------------------------------------------------------------------------------- -->
                <section>
                  Implementation in Node.js and Mongo-DB
                </section>

                <! ---------------------------------------------------------------------------------- -->
                <section>
                  EventSourcing ohne globalen State
                </section>
                
                <! ---------------------------------------------------------------------------------- -->
                <section>
                  Node: Single-Threaded, aber trotzdem ... (was?)
                </section>

                <! ---------------------------------------------------------------------------------- -->
                <section>
                  Implementierung Optimistic Locking
                </section>
                
                <! ---------------------------------------------------------------------------------- -->
                <section>
                  Implementierung Event Sourcing
                </section>
              </section>

              <!-- ********************************************************************************** -->
              <!-- Outcome -->
              <!-- ********************************************************************************** -->
              <section>
                <! ---------------------------------------------------------------------------------- -->
                <section>
                  Registration began
                  
                  but nobody registered!
                  
                  why?
                </section>

                <! ---------------------------------------------------------------------------------- -->
                <section>
                  Ablauf skizzieren. 
                  
                  First user came in
                  reading from DB parallelized it
                  somebody else modified the DB
                  first user could not save
                  retry
                  same happened again, and again
                  
                  reading of read and write models was slow
                  so many other connections came through and modified DB
                  
                  self-propelling disaster
                </section>

                <! ---------------------------------------------------------------------------------- -->
                <section>
                  After 25 minutes, I shut down the server.
                  
                  Nobody had been able to register.
                </section>
              </section>

              <!-- ********************************************************************************** -->
              <!-- Improvements -->
              <!-- ********************************************************************************** -->
              <section>
                <! ---------------------------------------------------------------------------------- -->
                <section>
                  Analysis: Because of parallelization, it was impossible for one user to get through.
                  
                  We must control parallelization.
                </section>

                <! ---------------------------------------------------------------------------------- -->
                <section>
                  Nachteil: Jetzt ist keine Parallelisierung von Prozessen mehr m√∂glich
                </section>

                <! ---------------------------------------------------------------------------------- -->
                <section>
                </section>
              </section>

 
              

              <!-- Danksagung ********************************************************************************** -->
              <section>
                <h2>Vielen Dank!</h2>

                <div class="container" style="align-items:flex-end;">

                  <div style="flex:2;">
                    <img style="width:80%;" src="../logos/German.png"/>
                  </div>
                  <div style="flex:3;">
                    <div style="font-family: Lato; font-weight:300; text-align:left;">@NicoleRauch</div>
                    <div style="font-family: Lato; font-weight:300; text-align:left;">info@nicole-rauch.de</div>
                    <div style="font-family: Lato; font-weight:300; text-align:left;margin-bottom:14px;">http://www.nicole-rauch.de</div>
                  </div>
                  
                </div>
                <div style="font-family: Lato, monospace; font-weight:300; text-align:left;margin-top:38px;">https://github.com/NicoleRauch/...</div>
                <div style="font-family: Lato, monospace; font-weight:300; text-align:left;margin-top:38px;">https://github.com/Softwerkskammer/Agora</div>

              </section>
              
              
			</div>
		</div>

		<script src="../reveal.js/lib/js/head.min.js"></script>
		<script src="../reveal.js/js/reveal.js"></script>

		<script>
			// More info https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
              // ********************* General **************************
              // Display a presentation progress bar
              progress: true,

              history: false, // TODO ?!
              
              // Enable keyboard shortcuts for navigation
              keyboard: true,

              // Enable the slide overview mode
              overview: true,

              // Vertical centering of slides
              center: true,
              
              // Transition style
              transition: 'fade', // none/fade/slide/convex/concave/zoom / default

              // ********************* Size **************************

              // The "normal" size of the presentation, aspect ratio will be preserved
              // when the presentation is scaled to fit different resolutions. Can be
              // specified using percentage units.
              width: 1024,
              height: 768,

              // Factor of the display size that should remain empty around the content
              margin: 0.05,

              

				// More info https://github.com/hakimel/reveal.js#dependencies
				dependencies: [
					{ src: '../reveal.js/plugin/markdown/marked.js' },
					{ src: '../reveal.js/plugin/markdown/markdown.js' },
					{ src: '../reveal.js/plugin/notes/notes.js', async: true },
					{ src: '../reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				]
			});
		</script>
	</body>
</html>
